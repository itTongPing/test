<!DOCTYPE html>
<html lang="en" xmlns="://.w3.org/1999/xhtml" xmlns:th="://.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <title>采购入库财务查询</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content=""/>
    <meta name="author" content=""/>
   	<head th:include="decorators/tags/main" />
    <head th:include="decorators/tags/menuBaiyi" />

    <link th:href="@{'/css/require-form.css?v='+${version}}" />
	<style>
        .bootstrap-table{
            position:static !important;
        }
		.warehouse{
			width:auto !important;
			top:43px;
			left:50px;
			white-space:nowrap !important;
		}
        .text_over{
            max-width:300px;
            text-align:left;
            text-overflow:ellipsis;
            white-space:nowrap;
            overflow:hidden;
            display:block;
        }
        .fa{
            display:none;
        }
	</style>
</head>

<body class="overflow-hidden" >
<div class="wrapper preload no-left">
    <ul class="breadcrumb">
        <li><span class="primary-font"><i class="icon-home"></i></span>供应链报表</li>
        <li>采购入库财务查询</li>
        <li>采购入库财务查询列表</li>
    </ul>
    <div class="main-container ">
        <div class="padding-md">
        <!-- 搜索栏 -->
        <form class="form-inline no-margin" id="queryForm" action = '' method = 'get'>
	        <div class="fun-btn">
	        	<button  type="button" id="export_btn" onclick="exportExcel()" class="btn btn-blue" role:secResName="report_reportfinance_export">导出</button>
	        </div>
	    </form>
	    <form class="form-inline no-margin" id='queryForm2'>
            <div class="smart-widget-inner product_info">
                <div class="search-form-div">
                    
                        <div class="search_l">
                        	<!-- 时间 -->
                            <div class="form-group ">入库时间
                                <div class="btn-group btn_group">
                                    <input size="16" type="text" id="from_date" name="from_date" value="" placeholder="开始时间" class="form-control form_datetime " data-date-format="yyyy-mm-dd"/>
                                    <input size="16" type="text" id="to_date" name="to_date" value="" placeholder="结束时间" class="form-control form_datetime " data-date-format="yyyy-mm-dd"/>
                                </div>
                           	</div>
                           	<!-- sku -->
                           	<div class="form-group">
                                <input type="text" id="sku" name="sku" class="form-control" placeholder="输入sku"/>
                            </div>
                            <!-- 供应商 -->
                           	<!-- <div class="form-group"></div> -->
                              <!--   <div class="btn-group goodsInquiry toGoodsInquiry">
                                		
                                        onkeyup="searchenter(this,event,0)" 
                                        <input type="text" name="supplier" id="supplier"  class="form-control"  onclick="javascript:this.select()" autocomplete="off"  onblur="checkValueIsempty(this)" placeholder="输入关键字检索"/>
                                    </div> -->
                                    <!-- 供应商 -->
								<div class="form-group">
									供应商 <input name="supplier" id="supplyAlias"
										placeholder="请输入供应商检索" class="form-control"
										th:value="${supplyAlias}" onkeyup="getStockList(this,event)"
										onfocus="getStockList(this,event)" style="font-size: 14px;" />
								</div>
                            
                             
                            <!-- 高级搜索 -->
                            <div class="btn-group marginTB-xs advanced-search" style="float: none; display: inline-block;margin-left:12px;">
                                <a type="button" data-toggle="dropdown" onclick="searchH()" class="uperSearch"> 高级搜索<img src="/images/new-vision/nav_right_user-name_arrow.png" /></a>
                            </div>
                        </div>
                        <div class="search_r">
                            <button type="button" class="btn btn-success marginTB-xs" onclick="searchResult()" role:secResName="report_reportfinance_search">搜索</button>
                            <img class="resetbutton" src="/images/icon_Advanced-search.png" onclick="searchReset()" />
                        </div>
                        <ul class="dropdown-menu" role="menu" id="searchH" style="display: none;">
                        	
                        	<!-- 采购单号 -->
                        	<div class="form-group">采购单号
                                <label class="sr-only"></label>
                                <input type="text" id="purchase_no" name="purchase_no" class="form-control" placeholder="输入采购单号"/>
                            </div>
                            <!-- 采购员 -->
                        	<div class="form-group">采购员
                                <label class="sr-only"></label>
                                <input type="text" id="buyer" name="buyer" class="form-control" placeholder="输入采购员"/>
                            </div>
                            
                            <div class="form-group" style="margin:5px 0">结算类型
                                <select class="selectpicker show-tick form-control" multiple="multiple"
                                        id="pay_type" data-live-search="false" name = 'pay_type'>
                                    <option value='-1' selected='true'>全部</option>
                                    <option value='0'>月结</option>
                                    <option value='1'>预付</option>
                                </select>
                            </div>
                            
                            <div class="form-group" style="margin:5px 0">结算方式
                                <select class="selectpicker show-tick form-control" multiple="multiple"
                                        id="payMethod" data-live-search="false" name = 'payType'>
                                    <option value='-1' selected='true'>全部</option>
                                    <option th:each="pay_type_name :${paymethods}"
                                            th:value="${pay_type_name.id}"
                                            th:text="${pay_type_name.name}" th:attr = "data-type = ${pay_type_name.type}"></option>
                                </select>
                            </div>
                            
                            <div class="form-group" style="margin:5px 0">仓库
                                <select class="selectpicker show-tick form-control" multiple="multiple"
                                        id="stock_id" data-live-search="false" name = 'stock_id'>
                                    <option value='-1' selected='true'>全部</option>
                                    <option th:each="inventory :${signWarehouse}"
	                                        th:value="${inventory.stock_id}"
	                                        th:text="${inventory.warehouse_name}"></option>
                                </select>
                            </div>
                            <div class="form-group" style="margin:5px 0">含税
                                <select class="selectpicker show-tick form-control" multiple="multiple"
                                        id="include_tax" data-live-search="false" name = 'include_tax'>
                                    <option value='-1' selected='true'>全部</option>
                                    <option th:each="tax :${tax}"
                                            th:value="${tax.value}"
                                            th:text="${tax.name}"></option>
                                </select>
                            </div>
                            
                            <div class="form-group" style="margin:5px 0">采购部门
                                <select class="selectpicker show-tick form-control" multiple="multiple"
                                        id="department" data-live-search="false" name = 'department'>
                                    <option value='-1' selected='true'>全部</option>
                                    <option th:each="department :${departments}"
                                            th:value="${department.groupId}"
                                            th:text="${department.groupName}"></option>
                                </select>
                            </div>
                            
                            <!-- 法人主体 -->
                            <div class="form-group" style="margin:5px 0">法人主体
	                            <select class="selectpicker show-tick form-control" multiple="multiple"
	                                    id="legaler" data-live-search="false" name = 'legaler'>
	                                <option value='-1' selected='true'>全部</option>
	                                <option th:each="legaler:${legalers}"
                                            th:text="${legaler}"></option>
	                            </select>
                           	</div>
                           	
                           	<div class="form-group ">采购时间
                                <div class="btn-group btn_group">
                                    <input size="16" type="text" id="from_purchase_date" name="from_purchase_date" value="" placeholder="开始时间" class="form-control form_datetime " data-date-format="yyyy-mm-dd"/>
                                    <input size="16" type="text" id="to_purchase_date" name="to_purchase_date" value="" placeholder="结束时间" class="form-control form_datetime " data-date-format="yyyy-mm-dd"/>
                                </div>
                           	</div>
                           	
                           	 <div class="form-group" style="margin:5px 0">需求部门
                                <select class="selectpicker show-tick form-control" multiple="multiple"
                                        id="departmentSale" data-live-search="false" name = 'dept_xq'>
                                    <option value='-1' selected='true'>全部</option>
                                    <option th:each="department :${departmentsSale}"
                                            th:value="${department.sales_group_id}"
                                            th:text="${department.sale_name}"></option>
                                </select>
                            </div>
                        </ul>
                    
                </div>
                <!-- 表格 -->
                <table id="table01" class="table table-striped table-hover look table-scroll"></table>

            </div><!-- ./smart-widget-inner -->
		</form>
        </div><!-- ./padding-md -->
        <!-- 点击目标仓库 -->
			<div class="warehouse">
            </div>
    </div><!-- /main-container -->

    <!-- 引入页脚 -->
    <head th:include="decorators/tags/footer_mini"/>
    
</div>
<!-- 当前页面脚本 -->
<script th:src="@{/flyer/js/flyer.ui.searches.js?v='+${version}}"></script>
<script th:src="@{'/js/finance/purchase_warehouse_list_finance.js?v='+${version}}"></script>

<script>
$("#from_purchase_date,#to_purchase_date").datetimepicker({
    format: 'yyyy-mm-dd',
    autoclose: true,
    language: 'zh-CN',
    minView: '2',
    toggleActive: false,
    zIndexOffset: 1,
    endDate: nowtime
});
var aaa = new Date();
aaa.setMonth(new Date().getMonth()-1);
var nowtime = new Date();
$("#from_date").datetimepicker({
    format: 'yyyy-mm-dd',
    autoclose: true,
    language: 'zh-CN',
    minView: '2',
    toggleActive: false,
    zIndexOffset: 1,
    endDate: nowtime
}).datetimepicker('setDate',aaa);
$("#to_date").datetimepicker({
    format: 'yyyy-mm-dd',
    autoclose: true,
    language: 'zh-CN',
    minView: '2',
    toggleActive: false,
    zIndexOffset: 1
}).datetimepicker('setDate',nowtime);

/* //检索的时候获取数据源
function requestData(keyword) {
 var _this = this;
 var queryParams = _this.options.queryParams;// 查询参数
 var searchName = _this.options.searchName;
 queryParams[searchName] = keyword.trim().toUpperCase();
 var data = localStorage.getItem(searchName);
 $.ajax({
     url:_this.options.url,
     data:queryParams,
     success:function(data){
         _this._data = data;
         _this.render(data);
         _this.eventSelected();
     }
 });
}

//自动检索插件的参数
var searchOption = {
    url:'',// 请求数据的url
    searchName: "warehouse_name",// 搜索的关键字名字
    fieldValue: "stock_id",// id
    fieldName: "warehouse_name",// 字段名字
    separtor: ",",// 多选的时候使用的分隔符
    spaceTime: 100, // 单位是毫秒 延迟时间
    // 选中之后的处理函数
    fnSelected: function(event) {
        var _this = this;
        $(event.target).attr('data-select',true);
    },
    // 用户重写ajax请求 获取数据的方式
    requestData:requestData,
    placeholder:""
};

//仓库号的自动检索功能
var intwarehouseOption = searchOption;
    intwarehouseOption.url = '/report/purchase/getSupplierInfo';
    intwarehouseOption.searchName="name",// 搜索的关键字名字
    intwarehouseOption.fieldValue="supplierId",// id
    intwarehouseOption.fieldName="supplierName",// 显示在输入框中的字段名字
    intwarehouseOption.queryParams = {type:1};// 设置请求参数
$(".toGoodsInquiry").searches(intwarehouseOption);// 调用实例化方法
// 输入框检索的时候 光标移开的时候绑定的事件 判断用户是否选中的值 没有选中的话 直接清空输入框
function checkValueIsempty (obj){
	console.info('----------');
	console.info($(obj).data('select'));
    if (!$(obj).data('select')) {
        $(obj).val('');
    }
} */



</script>
</body>
</html>
