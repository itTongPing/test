/*
Navicat MySQL Data Transfer

Source Server         : 10.1.1.86_QA(aukey_report)
Source Server Version : 50719
Source Host           : 10.1.1.86:3306
Source Database       : aukey_report

Target Server Type    : MYSQL
Target Server Version : 50719
File Encoding         : 65001

Date: 2018-01-25 17:31:06
*/
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- View structure for view_center_stock_info
-- ----------------------------
DROP VIEW
IF EXISTS `view_center_stock_info`;

CREATE ALGORITHM = UNDEFINED DEFINER = `aukey_report`@`10.1.1.%` 
SQL SECURITY DEFINER VIEW `view_center_stock_info` AS 
#FBA库存
SELECT
	sku,
	SUM(quantity) AS stock_count,
	'FBA库存' AS type
FROM
	aukey_report.center_fba_stock_count
WHERE	sku IS NOT NULL
GROUP BY
	sku
UNION ALL
#海外仓转运在途
SELECT
	sku,
	SUM(quantity) AS stock_count,
	'海外仓转运' AS type
FROM
	aukey_report.center_oversea_transport_in_transit
GROUP BY
	sku
UNION ALL
#头程在途数量
SELECT
	sku,
	SUM(quantity) AS stock_count,
	CASE transport_type
	WHEN '0' THEN '头程空运'
	WHEN '1' THEN '头程海运'
	WHEN '3' THEN '头程铁运'
	ELSE '无' END AS type
FROM
	aukey_report.center_head_in_transit
GROUP BY sku,transport_type
UNION ALL
#国内中转仓库存
SELECT
	sku,
	SUM(quantity) AS stock_count,
	'国内中转仓库存' AS type
FROM
	aukey_report.center_domestic_transfer_warehouse
GROUP BY sku
UNION ALL
#采购订单在途
SELECT
	sku,
	SUM(in_way_quantity) stock_count,
	'采购订单在途' AS type
FROM
	aukey_report.center_purchase_in_transit
GROUP BY sku
UNION ALL
#FBA退货在途
SELECT
	sku,
	SUM(quantity) AS stock_count,
	'FBA退货在途' AS type
FROM
	aukey_report.center_fba_in_transit
GROUP BY
	sku
UNION ALL
#海外仓库存
SELECT
	sku,
	SUM(quantity) AS stock_count,
	'海外仓库存' AS type
FROM
	aukey_report.center_oversea_warehouse
GROUP BY
	sku
;