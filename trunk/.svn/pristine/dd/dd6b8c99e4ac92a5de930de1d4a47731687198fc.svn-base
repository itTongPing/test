<!DOCTYPE html>
<html lang="en" xmlns="://.w3.org/1999/xhtml" xmlns:th="://.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <title>采购报关报表</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content=""/>
    <meta name="author" content=""/>
   	<head th:include="decorators/tags/main" />
	<link rel="stylesheet" href="/css/require-form.css" />
	<link  rel="stylesheet" th:href="@{'/css/modules/flyer.all.css?v='+${version}}"/>
    <link  rel="stylesheet" th:href="@{'/css/modules/flyer.extend.css?v='+${version}}"/>
    <head th:include="decorators/tags/menuBaiyi" />
    <style>
		.warehouse{
			width:auto !important;
			top: 43px;
			left: 50px;
			white-space: nowrap !important;
			min-width: 270px;
		}
		
		.title_class {
    		overflow: hidden;
    		text-overflow: ellipsis;
    		width: 100%;
    		display: inline-block;
		}
	</style>
</head>
<body class="overflow-hidden" >
<div class="wrapper preload no-left">
    <ul class="breadcrumb">
        <li><span class="primary-font"><i class="icon-home"></i></span>供应链报表</li>
        <li>采购报关报表</li>
    </ul>
    <div class="main-container ">
        <div class="padding-md">
        <!-- 搜索栏 -->
        <form class="form-inline no-margin" id="queryForm" action = '/report/declare/export' method = 'get'>
	        <div class="fun-btn">
	        	<button  type="button" onclick="form_submit()" class="btn btn-blue">导出</button>
		        <button id='fastExportBtn'  type="button" onclick="fastExport()" title="每次导出请间隔2分钟" class="btn btn-primary">快速导出</button>
	        </div>
            <div class="smart-widget-inner product_info">
                <div class="search-form-div">
                        <div class="search_l">
                        	<!-- 时间 -->
                            <div class="form-group">发票月份
                                <input size="16" type="text" id="month" name="month" value="" placeholder="填写时间" class="form-control form_datetime"/>
                            </div>
                            <!-- sku -->
                            <div class="form-group">
                                <input type="text" id="sku" name="sku" class="form-control" placeholder="输入sku进行查询"/>
                            </div>
                            <!-- 报关单号 -->
                            <div class="form-group" style="margin:5px 0">
	                            <input type="text" id="declare_no" name="declare_no" class="form-control" placeholder="输入报关单号查询"/>
                           	</div>
                           	<!-- 法人主体 -->
                            <div class="form-group" style="margin:5px 0">法人主体
                                <select id="legaler" class="selectpicker show-tick form-control" multiple="multiple"
                                        data-live-search="false" name = 'legaler'>
                                    <option value='-1' selected='true'>全部</option>
                                    <option th:each="legaler :${legalers}"
                                            th:text="${legaler}"></option>
                                </select>
                            </div>
                            <!-- 高级搜索 -->
                            <div class="btn-group marginTB-xs advanced-search" style="float: none; display: inline-block;margin-left:12px;">
                                <a type="button" data-toggle="dropdown" onclick="searchH()" class="uperSearch"> 高级搜索<img src="/images/new-vision/nav_right_user-name_arrow.png" /></a>
                            </div>
                        </div>
                        <div class="search_r">
                            <button type="button" id="search_result" class="btn btn-success marginTB-xs" onclick="searchResult()">搜索</button>
                            <img class="resetbutton" src="/images/icon_Advanced-search.png" onclick="searchReset()" />
                        </div>
                        <ul class="dropdown-menu" role="menu" id="searchH" style="display: none;">
                        	<!-- 采购单号 -->
                            <div class="form-group" style="margin:5px 0">采购单号
	                            <input type="text" id="purchase_no" name="purchase_no" class="form-control" placeholder="输入采购单号查询"/>
                           	</div>
                           	<!-- 供应商 -->
                            <div class="form-group" style="margin:5px 0">供应商
	                           <!--  <input type="text" id="supplier" name="supplier" class="form-control" placeholder="输入供应商名称检索"/> -->
	                            <input name="supplier" id="supplyAlias"	placeholder="请输入供应商检索" class="form-control"	th:value="${supplyAlias}" onkeyup="getStockList(this,event)" onfocus="getStockList(this,event)" style="font-size: 14px;" />
                           		
                           	</div>
                           	<!-- 采购部门 -->
                            <div class="form-group" style="margin:5px 0">采购部门
                                <select class="selectpicker show-tick form-control" multiple="multiple"
                                        id="department" data-live-search="false" name = 'department'>
                                    <option value='-1' selected='true'>全部</option>
                                    <option th:each="department :${departments}"
                                            th:value="${department.groupId}"
                                            th:text="${department.groupName}"></option>
                                </select>
                            </div>
                            <!-- 采购员 -->
                            <div class="form-group" style="margin:5px 0">采购员
	                            <input type="text" id="buyer" name="buyer" class="form-control" placeholder="输入采购员查询"/>
                           	</div>
                            <!-- 申报日期 -->
                            <div class="form-group" style="margin:5px 0">申报日期
	                            <input size="16" type="text" id="from_date" name="from_date" value="" placeholder="填写时间" class="form-control form_datetime"/>
                           		<input size="16" type="text" id="to_date" name="to_date" value="" placeholder="填写时间" class="form-control form_datetime"/>
                           	</div>
                           	<!-- 关联单号 -->
                            <div class="form-group" style="margin:5px 0">
	                            <input type="text" id="related_no" name="related_no" class="form-control" placeholder="请输入关联编号查询"/>
                           	</div>
                           	<!-- 报关状态 -->
                           	<div class="form-group declare_status" style="margin:5px 0">报关状态
	                            <select class="selectpicker show-tick form-control"
                                        id="declare_status" data-live-search="false" name = 'declare_status'>
                                    <option value='-1' selected='true'>全部</option>
									<option value='未开票'>未开票</option>
									<option value='部分开票'>部分开票</option>
									<option value='全部开票'>全部开票</option>
									<option value='开票完结'>开票完结</option>
                                    <!-- <option value='2'>未审核</option> -->
                                </select>
                           	</div>
                           	<!-- 退税说明 -->
                           	<div class="form-group" style="margin:5px 0">退税说明
	                            <input type="text" id="drawback_explain" name="drawback_explain" class="form-control" placeholder="请输入退税说明"/>
                           	</div>
                           	<!-- 退税审核员 -->
                           	<div class="form-group" style="margin:5px 0">退税审核员
	                            <input type="text" id="auditor_name" name="auditor_name" class="form-control" placeholder="请输入退税审核员"/>
                           	</div>
                           	<!-- 退税核验员 -->
                           	<div class="form-group" style="margin:5px 0">退税核验员
	                            <input type="text" id="verifer_name" name="verifer_name" class="form-control" placeholder="请输入退税核验员"/>
                           	</div>
                           	<!-- 审核时间 -->
                            <div class="form-group" style="margin:5px 0">审核时间
	                            <input size="16" type="text" id="from_audit_date" name="from_audit_date" value="" placeholder="填写时间" class="form-control form_datetime"/>
                           		<input size="16" type="text" id="to_audit_date" name="to_audit_date" value="" placeholder="填写时间" class="form-control form_datetime"/>
                           	</div>
                           	<!-- 核验时间 -->
                            <div class="form-group" style="margin:5px 0">核验时间
	                            <input size="16" type="text" id="from_verif_date" name="from_verif_date" value="" placeholder="填写时间" class="form-control form_datetime"/>
                           		<input size="16" type="text" id="to_verif_date" name="to_verif_date" value="" placeholder="填写时间" class="form-control form_datetime"/>
                           	</div>
                           	<!-- 是否无退税核验 -->
                            <div class="checkbox inline-block" style="width:33%">
                            	<div class="inline-block vertical-top">是否无退税核验</div>
	                            <div class="custom-checkbox">
	                                <input type="checkbox" id="has_no_verifer" name="has_no_verifer" class="checkbox-bblue" />
	                                <label for="has_no_verifer"></label>
	                            </div>
	                        </div>
                        </ul>
                    
                </div>
                <!-- 表格 -->
                <table id="table01" data-toggle="table"   class="table table-striped table-hover look table-scroll" data-query-params="query_params"  
                data-pagination="true" data-side-pagination="server" data-id-field="sku"  data-unique-id="sku" data-page-size="20"  
                data-page-list="[20, 50, 100, 200]"  data-sortable = "true" data-url = "/report/declare/search">
                    <thead class="tableThead">
                    	<th data-field = 'legaler_name'>法人主体</th>
						<th data-field = 'related_no' data-formatter = 'paper_detail'>关联编号</th>
						<th data-field = 'declare_status'>报关状态</th>
						<th data-field = 'sign_date'>填单日期</th>
						<th data-field = 'declare_date' data-formatter = 'formatDate'>申报日期</th>
						<th data-field = 'export_date' data-formatter = 'formatDate'>出口日期</th>
						<th data-field = 'declare_no' data-formatter='toContractOn'>报关单号</th>
						<th data-field = 'contract_no' >报关合同号</th>
						<th data-field = 'port'>口岸</th>
						<th data-field = 'item_no'>项号</th>
						<th data-field = 'customs_no'>海关编号</th>
						<th data-field = 'category'>品名</th>
						<th data-field = 'transaction_count'>成交数量</th>
						<th data-field = 'transaction_unit'>成交单位</th>
						<th data-field = 'price_tax'>单价RMB</th>
						<th data-field = 'total_price_tax'>含税总价RMB</th>
						<th data-field = 'total_usd_tax'>报关总价USD</th>
						<th data-field = 'purchase_no'>采购单号</th>
						<th data-field = 'sku'>sku</th>
						<th data-field = 'buyer_name'>采购员</th>
						<th data-field = 'department_name'>采购部门</th>
						<th data-field = 'supplier_name'>供应商</th>
						<th data-field = 'drawback_rate'>退税率</th>
						<th data-field = 'drawback_sum'>退税金额</th>
						<th data-field = 'producer_name'>制单人</th>
						<th data-field = 'bill_count'>开票数量</th>
						<th data-field = 'bill_no_tax_sum'>开票不含税金额</th>
						<th data-field = 'no_bill_count'>未开票数</th>
						<th data-field = 'drawback_explain' data-formatter = 'explain_formatter'>退税说明</th>
						<th data-field = 'bill_month'>发票月份</th>
						<th data-field = 'auditor_name'>退税审核员</th>
						<th data-field = 'verifer_name'>退税核验员</th>
						<th data-field = 'audit_time'>审核时间</th>
						<th data-field = 'verif_time'>核验时间</th>
                    </thead>
                </table>

            </div><!-- ./smart-widget-inner -->
		</form>
        </div><!-- ./padding-md -->
    </div><!-- /main-container -->
    
    <!-- 发票详情弹窗 -->
	<div class="modal fade" id="paper_detail" aria-hidden="false">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true"><font>×</font></span><span class="sr-only"><font>关闭</font></span></button>
                    <h4 class="modal-title">
                        <font>发票详情</font>
                    </h4>
                </div>
                <div class="modal-body">
                    <font>
                        <table id = 'paper_detail_table'
                        	data-toggle="table"
		                    class="table table-striped table-hover look"
		                    data-side-pagination="server"
		                    data-pagination="false"
		                    data-id-field="bill_no"
		                    data-unique-id="bill_no"
		                    data-url = "">
                        	<thead class="tableThead">
		                    	<!-- <th data-field = 'legaler'>状态</th> -->
								<th data-field='bill_no'>发票号码</th>
								<th data-field='invoice_serial_number'>发票编码</th>
								<th data-field='category'>品名</th>
								<th data-field='price_tax'>含税单价</th>
								<th data-field='price_wihtout_tax'>不含税单价</th>
								<th data-field='bill_count'>开票数量</th>
								<th data-field='sign_date' data-formatter = 'formatDate'>开票时间</th>
								<th data-field='operator'>录入人</th>
								<th data-field='entry_date' data-formatter = 'formatDate'>录入时间</th>
								<th data-field='invoice_count'>发票数量</th>
								<th data-field='surplus_count'>剩余数量</th>
								<th data-field='invoice_status'>开票状态</th>
		                    </thead>
                        </table>
                    </font>
                </div>
            </div>
        </div>
        <!-- 点击目标仓库 -->
		<div class="warehouse">
        </div>
    </div>
    <!-- 引入页脚 -->
    <head th:include="decorators/tags/footer_mini"/>
</div>
<!-- 当前页面脚本 -->
<script src = '/js/purchase_manage.js'></script>
<script th:src="@{'/bootstrap-table/js/bootstrap-table-ext.js?v='+${version}}"></script>
<script th:src="@{'/bootstrap-table/js/bootstrap-table-zh-CN.min.js?v='+${version}}"></script>
<script th:src="@{'/js/modules/flyer.all.js?v='+${version}}"></script>
<script th:src="@{'/js/modules/flyer.extend.js?v='+${version}}"></script>

<script type="text/javascript">

$(function(){
	/* $("#search_result").keydown(function (e) {
		alert("---");
	    if (e.which== 13) {
	    	alert("---");
	    	//searchResult();  
	    }  
	}); */
	$(document).keydown(function(event){ 
		if(event.keyCode==13){
			
		$("#search_result").click(); 
		} 
		}); 
})

</script>

</body>
</html>
